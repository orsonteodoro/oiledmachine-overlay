--- a/third_party/aotriton/CMakeLists.txt.orig	2025-12-07 19:50:15.388952740 -0800
+++ b/third_party/aotriton/CMakeLists.txt	2025-12-07 19:59:49.654530745 -0800
@@ -72,6 +72,7 @@ set(AOTRITON_BUILD_FOR_TUNING_BUT_SKIP_K
 option(AOTRITON_ENABLE_FP32_INPUTS "Enable FP32 support." ON)
 option(AOTRITON_NOIMAGE_MODE "Only build C++ Shim part. Kernel image builds are disabled" OFF)
 option(AOTRITON_INHERIT_SYSTEM_SITE_TRITON "Use system site packages and verify triton availability instead of building from source" OFF)
+option(AOTRITON_DISABLE_VENV "DISABLE_VENV" ON)
 # No plan to support network based pip install
 set(AOTRITON_USE_LOCAL_TRITON_WHEEL "" CACHE STRING "Substitute install from third_party/triton with install from local pip wheel package.")
 set(AOTRITON_GPU_BUILD_TIMEOUT "8.0" CACHE STRING "GPU kernel compiler times out after X minutes. 0 for indefinite. Highly recommended if AOTRITON_BUILD_FOR_TUNING=On.")
@@ -139,7 +140,9 @@ endif()
 set(Python_ARTIFACTS_INTERACTIVE TRUE)
 
 # Not a target, we need to override Python3_EXECUTABLE later
-if(AOTRITON_INHERIT_SYSTEM_SITE_TRITON)
+if(AOTRITON_DISABLE_VENV)
+  message(STATUS "Disabling venv")
+elseif(AOTRITON_INHERIT_SYSTEM_SITE_TRITON)
   execute_process(COMMAND "${Python3_EXECUTABLE}" -m venv --system-site-packages "${VENV_DIR}")
 else()
   execute_process(COMMAND "${Python3_EXECUTABLE}" -m venv "${VENV_DIR}")
@@ -150,8 +153,13 @@ message("VENV_DIR ${VENV_DIR}")
 if(WIN32)
   set(VENV_BIN_PYTHON "${VENV_DIR}/Scripts/python")
 else()
-  set(VENV_BIN_PYTHON "${VENV_DIR}/bin/python")
+  if(AOTRITON_DISABLE_VENV)
+    set(VENV_BIN_PYTHON "${Python3_EXECUTABLE}")
+  else()
+    set(VENV_BIN_PYTHON "${VENV_DIR}/bin/python")
+  endif()
 endif()
+message(STATUS "VENV_BIN_PYTHON:  ${VENV_BIN_PYTHON}")
 # set(Python3_FIND_VIRTUALENV FIRST)
 # unset(Python3_EXECUTABLE)
 # find_package(Python3 COMPONENTS Interpreter REQUIRED)
@@ -160,7 +168,9 @@ execute_process(COMMAND ${CMAKE_COMMAND}
 # string(STRIP "${VENV_SITE}" VENV_SITE)
 message("VENV_SITE ${VENV_SITE}")
 
-execute_process(COMMAND ${CMAKE_COMMAND} -E env VIRTUAL_ENV=${VENV_DIR} "${VENV_BIN_PYTHON}" -m pip install -r "${CMAKE_CURRENT_LIST_DIR}/requirements.txt")
+if(NOT AOTRITON_DISABLE_VENV)
+  execute_process(COMMAND ${CMAKE_COMMAND} -E env VIRTUAL_ENV=${VENV_DIR} "${VENV_BIN_PYTHON}" -m pip install -r "${CMAKE_CURRENT_LIST_DIR}/requirements.txt")
+endif()
 
 if(AOTRITON_NOIMAGE_MODE)
   message(STATUS "[AOTriton] Skipping triton due to AOTRITON_NOIMAGE_MODE")
