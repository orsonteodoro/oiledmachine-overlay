--- a/kernel/Makefile.orig	2024-02-13 15:06:58.402873426 -0800
+++ b/kernel/Makefile	2024-02-13 15:07:26.970578500 -0800
@@ -115,6 +115,7 @@ obj-$(CONFIG_HAVE_STATIC_CALL) += static
 obj-$(CONFIG_HAVE_STATIC_CALL_INLINE) += static_call_inline.o
 obj-$(CONFIG_CFI_CLANG) += cfi.o
 obj-$(CONFIG_NUMA) += numa.o
+obj-$(CONFIG_PGO_CLANG) += pgo/
 
 obj-$(CONFIG_PERF_EVENTS) += events/
 
--- a/arch/x86/um/vdso/Makefile.orig	2024-02-13 15:04:53.028167559 -0800
+++ b/arch/x86/um/vdso/Makefile	2024-02-13 15:06:58.402873426 -0800
@@ -67,3 +67,4 @@ quiet_cmd_vdso = VDSO    $@
 
 VDSO_LDFLAGS = -fPIC -shared -Wl,--hash-style=sysv -z noexecstack
 GCOV_PROFILE := n
+PGO_PROFILE := n
--- a/arch/x86/Kconfig.orig	2024-02-13 15:04:52.616171812 -0800
+++ b/arch/x86/Kconfig	2024-02-13 15:06:58.406873385 -0800
@@ -119,6 +119,7 @@ config X86
 	select ARCH_USES_CFI_TRAPS		if X86_64 && CFI_CLANG
 	select ARCH_SUPPORTS_LTO_CLANG
 	select ARCH_SUPPORTS_LTO_CLANG_THIN
+	select ARCH_SUPPORTS_PGO_CLANG		if X86_64
 	select ARCH_USE_BUILTIN_BSWAP
 	select ARCH_USE_CMPXCHG_LOCKREF		if X86_CMPXCHG64
 	select ARCH_USE_MEMTEST
--- a/Documentation/dev-tools/index.rst.orig	2024-02-13 15:06:58.406873385 -0800
+++ b/Documentation/dev-tools/index.rst	2024-02-13 15:07:43.802404724 -0800
@@ -32,6 +32,7 @@ Documentation/dev-tools/testing-overview
    kunit/index
    ktap
    checkuapi
+   pgo
 
 
 .. only::  subproject and html
