<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pkgmetadata SYSTEM "https://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
  <maintainer type="project">
    <!-- ebuild fork only on the oiledmachine overlay -->
    <email>orsonteodoro@hotmail.com</email>
    <name>Orson Teodoro</name>
  </maintainer>
  <maintainer type="project">
    <!-- ebuild originator -->
    <email>llvm@gentoo.org</email>
  </maintainer>
  <longdescription>
    This ebuild fork enables Full RELRO ON by default.  This is to match the
    same RELRO level of the binutils counterpart.

    eclass/ebuild creators can check the -v to determine if the linker meets the
    required default RELRO security level for the app, but it can be overridden
    by changing the linker from now to lazy binding or from relro to norelro
    binding which the -v will not dynamically change and recognize.  One still
    needs to check the build logs to see if the program unecessarily overrides
    the default.


    Deterministic reliable builds

    Due to the problematic design of the live ebuild system, it
    is recommened to use a commit snapshot on the same slot for all
    LLVM live packages.  To have deterministic builds, per-package
    environmental variable must be set by adding the following once a
    successful build of LLVM has been discovered:

Contents of /etc/portage/env/llvm-14-commit.conf:
EGIT_OVERRIDE_COMMIT_LLVM_LLVM_PROJECT="ADD_40_DIGIT_COMMIT_HERE"

Contents of /etc/portage/package.env:
sys-devel/llvm:14 llvm-14-commit.conf
sys-devel/clang:14 llvm-14-commit.conf
=sys-libs/compiler-rt-14* llvm-14-commit.conf
=sys-libs/compiler-rt-sanitizers-14* llvm-14-commit.conf
sys-libs/libcxx:14 llvm-14-commit.conf
sys-libs/libcxxabi:14 llvm-14-commit.conf
sys-libs/libomp:14 llvm-14-commit.conf
sys-devel/lld:14 llvm-14-commit.conf

  Then, emerge -1 all of the above ebuilds.

  Replace 14 with the particular slots of the live ebuilds that you are
  interested.  When you need to update, just add and remove a # in front
  of EGIT_OVERRIDE_COMMIT_LLVM_LLVM_PROJECT to switch on and off when
  updating the 40 digit hash code again.
  </longdescription>
  <use>
    <flag name="hardened">Enables Full RELRO by default</flag>
  </use>
</pkgmetadata>
