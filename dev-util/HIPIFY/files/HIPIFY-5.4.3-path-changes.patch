diff -urp HIPIFY-rocm-5.4.3.orig/CMakeLists.txt HIPIFY-rocm-5.4.3/CMakeLists.txt
--- HIPIFY-rocm-5.4.3.orig/CMakeLists.txt	2023-08-23 14:34:48.985707733 -0700
+++ HIPIFY-rocm-5.4.3/CMakeLists.txt	2023-08-23 14:35:05.169708135 -0700
@@ -106,12 +106,12 @@ if(UNIX)
     #get rid of any RPATH definations already
     set_target_properties(hipify-clang PROPERTIES INSTALL_RPATH "")
     #set RPATH for the binary
-    set_target_properties(hipify-clang PROPERTIES LINK_FLAGS "-Wl,--disable-new-dtags -Wl,--rpath,$ORIGIN/../lib" )
+    set_target_properties(hipify-clang PROPERTIES LINK_FLAGS "-Wl,--disable-new-dtags -Wl,--rpath,$ORIGIN/../@LIBDIR@" )
 
     if(FILE_REORG_BACKWARD_COMPATIBILITY)
         include(hipify-backward-compat.cmake)
     endif()
-    set(CPACK_PACKAGING_INSTALL_PREFIX "/opt/rocm" CACHE PATH "HIP Package Installation Path")
+    set(CPACK_PACKAGING_INSTALL_PREFIX "@EPREFIX_ROCM_PATH@" CACHE PATH "HIP Package Installation Path")
     set(BUILD_DIR ${CMAKE_CURRENT_BINARY_DIR}/packages/hipify-clang)
     configure_file(packaging/hipify-clang.txt ${BUILD_DIR}/CMakeLists.txt @ONLY)
     configure_file(${CMAKE_SOURCE_DIR}/LICENSE.txt ${BUILD_DIR}/LICENSE.txt @ONLY)
diff -urp HIPIFY-rocm-5.4.3.orig/hipify-backward-compat.cmake HIPIFY-rocm-5.4.3/hipify-backward-compat.cmake
--- HIPIFY-rocm-5.4.3.orig/hipify-backward-compat.cmake	2022-11-08 07:14:13.000000000 -0800
+++ HIPIFY-rocm-5.4.3/hipify-backward-compat.cmake	2023-08-23 14:35:05.169708135 -0700
@@ -23,9 +23,9 @@ set(HIPIFY_BUILD_DIR ${CMAKE_CURRENT_BIN
 set(HIPIFY_WRAPPER_DIR ${HIPIFY_BUILD_DIR}/wrapper_dir)
 set(HIPIFY_WRAPPER_BIN_DIR ${HIPIFY_WRAPPER_DIR}/bin)
 
-#With File Reorganization , hipify(and hip)  will be installed in /opt/rocm-ver
-#instead of  /opt/rocm-ver/hip/. For maintaining backward  compatibility
-# the previous location(/opt/rocm-ver/hip/) will have soft link.
+#With File Reorganization , hipify(and hip)  will be installed in @ESYSROOT_ROCM_PATH@
+#instead of  @ESYSROOT_ROCM_PATH@/hip/. For maintaining backward  compatibility
+# the previous location(@ESYSROOT_ROCM_PATH@/hip/) will have soft link.
 #This file is for creating  soft link to binary files and install it in the  previous location
 #Note: soft link added for binary files.
 
diff -urp HIPIFY-rocm-5.4.3.orig/README.md HIPIFY-rocm-5.4.3/README.md
--- HIPIFY-rocm-5.4.3.orig/README.md	2022-11-08 07:14:13.000000000 -0800
+++ HIPIFY-rocm-5.4.3/README.md	2023-08-23 14:36:01.825709540 -0700
@@ -43,7 +43,7 @@ After applying all the matchers, the out
 
 `hipify-clang` requires:
 
-1. [**LLVM+CLANG**](http://releases.llvm.org) of at least version [4.0.0](http://releases.llvm.org/download.html#4.0.0); the latest stable and recommended release: [**15.0.4**](https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4).
+1. [**LLVM+CLANG**](http://releases.llvm.org) of at least version [4.0.0](http://releases.llvm.org/download.html#4.0.0); the latest stable and recommended release: [**15.0.4**](https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4).
 
 2. [**CUDA**](https://developer.nvidia.com/cuda-downloads) of at least version [8.0](https://developer.nvidia.com/cuda-80-ga2-download-archive), the latest supported version is [**11.8.0**](https://developer.nvidia.com/cuda-downloads).
 
@@ -175,7 +175,7 @@ After applying all the matchers, the out
           <a href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.1">15.0.1</a>,<br>
           <a href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.2">15.0.2</a>,
           <a href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.3">15.0.3</a>,<br>
-          <a href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4"><b>15.0.4</b></a></td>
+          <a href="https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4"><b>15.0.4</b></a></td>
       <td bgcolor="eefaeb"><a href="https://developer.nvidia.com/cuda-downloads"><b>11.8.0</b></a></td>
       <td colspan=2 bgcolor="eefaeb"><font color="green"><b>LATEST STABLE CONFIG</b></font></td>
     </tr>
@@ -191,7 +194,7 @@ After applying all the matchers, the out
 In most cases, you can get a suitable version of `LLVM+CLANG` with your package manager.
 
 Failing that or having multiple versions of `LLVM`, you can [download a release archive](http://releases.llvm.org/), build or install it, and set
-[CMAKE_PREFIX_PATH](https://cmake.org/cmake/help/v3.5/variable/CMAKE_PREFIX_PATH.html) so `cmake` can find it; for instance: `-DCMAKE_PREFIX_PATH=d:\LLVM\15.0.4\dist`
+[CMAKE_PREFIX_PATH](https://cmake.org/cmake/help/v3.5/variable/CMAKE_PREFIX_PATH.html) so `cmake` can find it; for instance: `-DCMAKE_PREFIX_PATH=d:\LLVM\15.0.4\dist`
 
 ### <a name="hipify-clang-usage"></a> hipify-clang: usage
 
@@ -200,14 +203,14 @@ To process a file, `hipify-clang` needs
 For example:
 
 ```shell
-./hipify-clang square.cu --cuda-path=/usr/local/cuda-11.8 -I /usr/local/cuda-11.8/samples/common/inc
+./hipify-clang square.cu --cuda-path=/opt/cuda -I /opt/cuda/samples/common/inc
 ```
 
 `hipify-clang` arguments are given first, followed by a separator `'--'`, and then the arguments you'd pass to `clang` if you
 were compiling the input file. For example:
 
 ```bash
-./hipify-clang cpp17.cu --cuda-path=/usr/local/cuda-11.8 -- -std=c++17
+./hipify-clang cpp17.cu --cuda-path=/opt/cuda -- -std=c++17
 ```
 
 The [Clang manual for compiling CUDA](https://llvm.org/docs/CompileCudaWithLLVM.html#compiling-cuda-code) may be useful.
@@ -252,63 +255,22 @@ The binary can then be found at `./dist/
 
 `LLVM+CLANG` should be built from sources, pre-built binaries are not exhaustive for testing. Before building ensure that the [software required for building](https://releases.llvm.org/11.0.0/docs/GettingStarted.html#software) is of an appropriate version.
 
-**LLVM <= 9.0.1:**
+**LLVM == 15.0.4:**
 
-1. download [`LLVM`](https://github.com/llvm/llvm-project/releases/download/llvmorg-9.0.1/llvm-9.0.1.src.tar.xz)+[`CLANG`](https://github.com/llvm/llvm-project/releases/download/llvmorg-9.0.1/clang-9.0.1.src.tar.xz) sources; 
-2. build [`LLVM+CLANG`](http://releases.llvm.org/9.0.0/docs/CMake.html):
-
-```bash
-     cd .. \
-     mkdir build dist \
-     cd build
-```
-
- **Linux**:
-   ```bash
-        cmake \
-         -DCMAKE_INSTALL_PREFIX=../dist \
-         -DLLVM_SOURCE_DIR=../llvm \
-         -DLLVM_TARGETS_TO_BUILD="X86;NVPTX" \
-         -DCMAKE_BUILD_TYPE=Release \
-         ../llvm
-        make -j install
-   ```
- **Windows**:
-   ```shell
-        cmake \
-         -G "Visual Studio 16 2019" \
-         -A x64 \
-         -Thost=x64 \
-         -DCMAKE_INSTALL_PREFIX=../dist \
-         -DLLVM_SOURCE_DIR=../llvm \
-         -DLLVM_TARGETS_TO_BUILD="NVPTX" \
-         -DCMAKE_BUILD_TYPE=Release \
-         ../llvm
-   ```
-Run `Visual Studio 16 2019`, open the generated `LLVM.sln`, build all, and build the `INSTALL` project.
-
-**LLVM >= 10.0.0:**
-
-1. download [`LLVM project`](https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4) sources;
+1. download [`LLVM project`](https://github.com/llvm/llvm-project/releases/tag/llvmorg-15.0.4) sources;
 2. build [`LLVM project`](http://llvm.org/docs/CMake.html):
 
-```bash
-      cd .. \
-      mkdir build dist \
-      cd build
-```
 
  **Linux**:
    ```bash
-        cmake \
-         -DCMAKE_INSTALL_PREFIX=../dist \
-         -DLLVM_TARGETS_TO_BUILD="X86;NVPTX" \
-         -DLLVM_ENABLE_PROJECTS="clang" \
-         -DCMAKE_BUILD_TYPE=Release \
-         ../llvm-project/llvm
-        make -j install
+        emerge -1 =llvm-15.0.4*[llvm_targets_X86,llvm_targets_NVPTX]
    ```
  **Windows**:
+  ```bash
+       cd .. \
+       mkdir build dist \
+       cd build
+   ```
    ```shell
         cmake \
          -G "Visual Studio 17 2022" \
@@ -354,27 +316,27 @@ Run `Visual Studio 17 2022`, open the ge
 
     * Install `lit` into `python`:
 
-        - ***Linux***: `python /usr/llvm/15.0.4/llvm-project/llvm/utils/lit/setup.py install`
+        - ***Linux***: `emerge lit`
 
-        - ***Windows***: `python d:/LLVM/15.0.4/llvm-project/llvm/utils/lit/setup.py install`
+        - ***Windows***: `python d:/LLVM/15.0.4/llvm-project/llvm/utils/lit/setup.py install`
 
-    * Starting with LLVM 6.0.1 path to `llvm-lit` python script should be specified by the `LLVM_EXTERNAL_LIT` option:
+    * Starting with LLVM 6.0.1 path to `lit` python script should be specified by the `LLVM_EXTERNAL_LIT` option:
 
-        - ***Linux***: `-DLLVM_EXTERNAL_LIT=/usr/llvm/15.0.4/build/bin/llvm-lit`
+        - ***Linux***: `-DLLVM_EXTERNAL_LIT=/usr/bin/lit`
 
-        - ***Windows***: `-DLLVM_EXTERNAL_LIT=d:/LLVM/15.0.4/build/Release/bin/llvm-lit.py`
+        - ***Windows***: `-DLLVM_EXTERNAL_LIT=d:/LLVM/15.0.4/build/Release/bin/llvm-lit.py`
 
     * `FileCheck`:
 
-        - ***Linux***: copy from `/usr/llvm/15.0.4/build/bin/` to `CMAKE_INSTALL_PREFIX/dist/bin`
+        - ***Linux***: copy from `/usr/lib/llvm/15/bin/` to `CMAKE_INSTALL_PREFIX/dist/bin`
 
-        - ***Windows***: copy from `d:/LLVM/15.0.4/build/Release/bin` to `CMAKE_INSTALL_PREFIX/dist/bin`
+        - ***Windows***: copy from `d:/LLVM/15.0.4/build/Release/bin` to `CMAKE_INSTALL_PREFIX/dist/bin`
 
         - Or specify the path to `FileCheck` in `CMAKE_INSTALL_PREFIX` option
 
 8. To run OpenGL tests successfully on:
 
-        - ***Linux***: install at least essential GL headers (on Ubuntu by `sudo apt-get install mesa-common-dev`)
+        - ***Linux***: install at least essential GL headers (by `emerge mesa`)
 
         - ***Windows***: nothing to do: all the required headers are shipped with Windows SDK
 
@@ -407,11 +369,11 @@ cmake
  -DHIPIFY_CLANG_TESTS=1 \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_INSTALL_PREFIX=../dist \
- -DCMAKE_PREFIX_PATH=/usr/llvm/15.0.4/dist \
- -DCUDA_TOOLKIT_ROOT_DIR=/usr/local/cuda \
- -DCUDA_DNN_ROOT_DIR=/usr/local/cuda \
+ -DCMAKE_PREFIX_PATH=/usr/lib/llvm/15 \
+ -DCUDA_TOOLKIT_ROOT_DIR=/opt/cuda \
+ -DCUDA_DNN_ROOT_DIR=/opt/cuda \
  -DCUDA_CUB_ROOT_DIR=/usr/CUB \
- -DLLVM_EXTERNAL_LIT=/usr/llvm/15.0.4/build/bin/llvm-lit \
+ -DLLVM_EXTERNAL_LIT=/usr/bin/lit \
  ../hipify
 ```
 *A corresponding successful output:*
@@ -428,21 +390,21 @@ cmake
 -- Check for working CXX compiler: /usr/bin/c++ - skipped
 -- Detecting CXX compile features
 -- Detecting CXX compile features - done
--- Found ZLIB: /usr/lib/x86_64-linux-gnu/libz.so (found version "1.2.11")
--- Found LLVM 15.0.4:
---    - CMake module path: /usr/llvm/15.0.4/dist/lib/cmake/llvm
---    - Include path     : /usr/llvm/15.0.4/dist/include
---    - Binary path      : /usr/llvm/15.0.4/dist/bin
+-- Found ZLIB: /usr/@LIBDIR@/libz.so (found version "1.2.11")
+-- Found LLVM 15.0.4:
+--    - CMake module path: /usr/lib/llvm/15/@LIBDIR@/cmake/llvm
+--    - Include path     : /usr/lib/llvm/15/include
+--    - Binary path      : /usr/lib/llvm/15/bin
 -- Linker detection: GNU ld
 -- Found PythonInterp: /usr/bin/python (found suitable version "3.9.7", minimum required is "2.7")
--- Found lit: /usr/local/bin/lit
--- Found FileCheck: /usr/llvm/15.0.4/dist/bin/FileCheck
+-- Found lit: /usr/bin/lit
+-- Found FileCheck: /usr/lib/llvm/15/bin/FileCheck
 -- Looking for pthread.h
 -- Looking for pthread.h - found
 -- Performing Test CMAKE_HAVE_LIBC_PTHREAD
 -- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
 -- Found Threads: TRUE
--- Found CUDA: /usr/local/cuda (found version "11.8")
+-- Found CUDA: /opt/cuda (found version "11.8")
 -- Configuring done
 -- Generating done
 -- Build files have been written to: /usr/hipify/build
@@ -455,7 +417,7 @@ make test-hipify
 Running HIPify regression tests
 ========================================
 CUDA 11.8 - will be used for testing
-LLVM 15.0.4 - will be used for testing
+LLVM 15.0.4 - will be used for testing
 x86_64 - Platform architecture
 Linux 5.13.0-21-generic - Platform OS
 64 - hipify-clang binary bitness
@@ -582,23 +544,23 @@ cmake
  -DHIPIFY_CLANG_TESTS=1 \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_INSTALL_PREFIX=../dist \
- -DCMAKE_PREFIX_PATH=d:/LLVM/15.0.4/dist \
+ -DCMAKE_PREFIX_PATH=d:/LLVM/15.0.4/dist \
  -DCUDA_TOOLKIT_ROOT_DIR="c:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v11.8" \
  -DCUDA_SDK_ROOT_DIR="c:/ProgramData/NVIDIA Corporation/CUDA Samples/v11.8" \
  -DCUDA_DNN_ROOT_DIR=d:/CUDNN/cudnn-11.8-windows-x64-v8.6.0 \
  -DCUDA_CUB_ROOT_DIR=d:/GIT/cub \
- -DLLVM_EXTERNAL_LIT=d:/LLVM/15.0.4/build/Release/bin/llvm-lit.py \
+ -DLLVM_EXTERNAL_LIT=d:/LLVM/15.0.4/build/Release/bin/llvm-lit.py \
  ../hipify
 ```
 *A corresponding successful output:*
 ```shell
--- Found LLVM 15.0.4:
---    - CMake module path: d:/LLVM/15.0.4/dist/lib/cmake/llvm
---    - Include path     : d:/LLVM/15.0.4/dist/include
---    - Binary path      : d:/LLVM/15.0.4/dist/bin
+-- Found LLVM 15.0.4:
+--    - CMake module path: d:/LLVM/15.0.4/dist/lib/cmake/llvm
+--    - Include path     : d:/LLVM/15.0.4/dist/include
+--    - Binary path      : d:/LLVM/15.0.4/dist/bin
 -- Found PythonInterp: c:/Program Files/Python311/python.exe (found suitable version "3.11.0", minimum required is "3.6")
 -- Found lit: c:/Program Files/Python311/Scripts/lit.exe
--- Found FileCheck: d:/LLVM/15.0.4/dist/bin/FileCheck.exe
+-- Found FileCheck: d:/LLVM/15.0.4/dist/bin/FileCheck.exe
 -- Found CUDA: c:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v11.8 (found version "11.8")
 -- Configuring done
 -- Generating done
