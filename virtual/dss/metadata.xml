<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
  <maintainer type="person">
    <!-- Ebuild on the oiledmachine-overlay -->
    <email>orsonteodoro@hotmail.com</email>
    <name>Orson Teodoro</name>
  </maintainer>
  <use>
    <!--

      oiledmachine-overlay notes:

      (DRAFT)

      There are two hosts -- audit workstation and production system.

      audit workstation - jump box [a central and single access point computer that controls and records admin access], admin console
                          The audit workstation will test and measure the other production system.

      production system - server, container, vm

      Security scores:

      | Profile                 | Online banking    | Cryptocurrency mining/banking | Distributed Blender rendering | Learning curve score [1]  | Avg security score |
      | ---                     | ---               | ---                           | ---                           | ---                       | ---                |
      | distro standard install | 6.0               | 3.0                           | 2.0                           | 0.00                      | 4.3                |
      | casual                  | 6.5 [3] / 9.2 [4] | 3.0 [2] / 9.1 [4]             | 2.0 [3] / 8.7 [4]             | 0.67 [3] / 0.83 [4]       | 3.8 [3] / 8.7 [4]  |
      | flexible                | 9.8               | 8.8                           | 8.5 [3] / 9.1 [4]             | 2.33                      | 9.1                |
      | compliant               | 10.0              | 9.5                           | 9.5                           | 7.17                      | 9.8                |

    [1] Low scores are easy, but high scores are difficult.
    [2] Miner is unsandboxed.
    [3] Unsandboxed estimated score.
    [4] Sandboxed estimated score.


    Password managers are allowed on flexible and compliant profiles but must follow rules:

    1.  Strong encryption
    2.  Encrypted keyfiles, no plaintext
    3.  Access to keyfiles must be logged
    4.  Sync-update must be performed manually
    5.  Password managers are not allowed on the production environment (aka CDE) in the compliant profile.


    For the compliant profile,

    1.  Extraenous software must be removed to avoid weaponization or backdoors.
    2.  All execution of contents of containers (Flatpak, AppImage, etc.) must be logged via auditd.
    3.  The allowed file set set must be the minimum required to carry out the task.
    4.  Partitioning and encryption required for dev/builder and production mount points and environments.
        - Compilers are disallowed in the production environment.
        - The production environment must be min set of files, config, and executibles to perform the task.
        - The dev/builder partition and production partition are encrypted.
    5.  Only open source software allowed in the production environment for code audit.

    -->
    <flag name="audit">
      Add packages for maintenance or the audit workstation.
    </flag>
    <flag name="production">
      Add packages for the production system.
    </flag>

    <flag name="enforce">
      Enforce package checks and systemwide flag checks.
    </flag>

    <flag name="casual">
      Adjusted data security that is not overkill for home users but still
      scores high.
    </flag>
    <flag name="compliant">
      Limit package selection what is allowed universally in standard data
      security audits.  It is required for payment card readers.
    </flag>
    <flag name="flexible">
      Allow for open-ended package selection which some may be more superior
      security alternatives than what auditors may allow.
    </flag>

    <flag name="apparmor">
      Add AppArmor support for containers, desktop, or server environments.
    </flag>
    <flag name="selinux">
      Add SELinux support for enterprise environments or critical infrastructure.
    </flag>
    <flag name="smack">
      Add SMACK support for IOT, embedded, automotive devices.
    </flag>
    <flag name="tomoyo">
      Add Tomoyo support for system analysis or learned confinement.
    </flag>

    <flag name="aide">
      Use AIDE for file fingerprinting and report inconsistencies.

      Important fingerprints for compliance:
      - System config and binaries
      - User config and data
      
      Use AI to help set up private reporting or mail based reporting.
    </flag>

    <flag name="custom-sources">
      Manually rebuild the kernel with SSP, _FORTIFY_SOURCE, KPTI, ASan
      KCFI, page zeroing and panic_on_warn=1.  At least, AppArmor or
      SELinux is required.

      For standard production, disable KASAN and UBSAN, enable KFENCE.
      For standard testing, enable KASAN and UBSAN.
      For relaxed production, enable KASAN and UBSAN, disable KFENCE.
    </flag>
    <flag name="gentoo-sources">
      Manually rebuild the kernel with SSP, _FORTIFY_SOURCE, KPTI, ASan
      KCFI, page zeroing and panic_on_warn=1.  At least, AppArmor or
      SELinux is required.

      For standard production, disable KASAN and UBSAN, enable KFENCE.
      For standard testing, enable KASAN and UBSAN.
      For relaxed production, enable KASAN and UBSAN, disable KFENCE.
    </flag>
    <flag name="git-sources">
      Manually rebuild the kernel with SSP, _FORTIFY_SOURCE, KPTI, ASan
      KCFI, page zeroing and panic_on_warn=1.  At least, Apparmor or
      SELinux is required.

      For standard production, disable KASAN and UBSAN, enable KFENCE.
      For standard testing, enable KASAN and UBSAN.
      For relaxed production, enable KASAN and UBSAN, disable KFENCE.
    </flag>
    <flag name="ot-sources">
      Manually rebuild the kernel with work profile set to dss and hardened
      level to secure-af
    </flag>
    <flag name="vanilla-sources">
      Manually rebuild the kernel with SSP, _FORTIFY_SOURCE, KPTI, ASan
      KCFI, page zeroing and panic_on_warn=1.  At least, AppArmor or
      SELinux is required.

      For standard production, disable KASAN and UBSAN, enable KFENCE.
      For standard testing, enable KASAN and UBSAN.
      For relaxed production, enable KASAN and UBSAN, disable KFENCE.
    </flag>
  </use>
</pkgmetadata>
