--- a/CMakeLists.txt.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/CMakeLists.txt	2025-12-22 09:27:14.432778564 -0800
@@ -29,6 +29,7 @@ include(SetupLLVM)
 
 parse_package_json(VERSION_VARIABLE DEFAULT_VERSION)
 optionx(VERSION STRING "The version of Bun" DEFAULT ${DEFAULT_VERSION})
+optionx(OFFLINE BOOL "Use offline downloads" DEFAULT ON)
 project(Bun VERSION ${VERSION})
 
 # Bun uses C++23, which is compatible with BoringSSL's C++17 requirement
--- a/cmake/Globals.cmake.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/cmake/Globals.cmake	2025-12-22 09:36:34.628614670 -0800
@@ -701,6 +701,7 @@ function(register_repository)
       "Cloning ${GIT_NAME}"
     COMMAND
       ${CMAKE_COMMAND}
+        -DOFFLINE=${OFFLINE}
         -DGIT_PATH=${GIT_PATH}
         -DGIT_REPOSITORY=${GIT_REPOSITORY}
         -DGIT_NAME=${GIT_NAME}
--- a/cmake/scripts/GitClone.cmake.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/cmake/scripts/GitClone.cmake	2025-12-22 09:32:32.646187511 -0800
@@ -22,23 +22,26 @@ endif()
 
 set(GIT_DOWNLOAD_URL https://github.com/${GIT_REPOSITORY}/archive/${GIT_REF}.tar.gz)
 
-message(STATUS "Cloning ${GIT_REPOSITORY} at ${GIT_REF}...")
-execute_process(
-  COMMAND
-    ${CMAKE_COMMAND}
-      -DDOWNLOAD_URL=${GIT_DOWNLOAD_URL}
-      -DDOWNLOAD_PATH=${GIT_PATH}
-      -DDOWNLOAD_FILTERS=${GIT_FILTERS}
-      -P ${CMAKE_CURRENT_LIST_DIR}/DownloadUrl.cmake
-  ERROR_STRIP_TRAILING_WHITESPACE
-  ERROR_VARIABLE
-    GIT_ERROR
-  RESULT_VARIABLE
-    GIT_RESULT
-)
-
-if(NOT GIT_RESULT EQUAL 0)
-  message(FATAL_ERROR "Clone failed: ${GIT_ERROR}")
+if(NOT OFFLINE)
+  message(STATUS "Cloning ${GIT_REPOSITORY} at ${GIT_REF}...")
+  execute_process(
+    COMMAND
+      ${CMAKE_COMMAND}
+        -DDOWNLOAD_URL=${GIT_DOWNLOAD_URL}
+        -DDOWNLOAD_PATH=${GIT_PATH}
+        -DDOWNLOAD_FILTERS=${GIT_FILTERS}
+        -P ${CMAKE_CURRENT_LIST_DIR}/DownloadUrl.cmake
+    ERROR_STRIP_TRAILING_WHITESPACE
+    ERROR_VARIABLE
+      GIT_ERROR
+    RESULT_VARIABLE
+      GIT_RESULT
+  )
+  if(NOT GIT_RESULT EQUAL 0)
+    message(FATAL_ERROR "Clone failed: ${GIT_ERROR}")
+  endif()
+else()
+  message(STATUS "Using cached download for ${GIT_DOWNLOAD_URL}...")
 endif()
 
 file(GLOB_RECURSE GIT_PATCH_PATHS ${CMAKE_SOURCE_DIR}/patches/${GIT_NAME}/*)
--- a/cmake/Globals.cmake.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/cmake/Globals.cmake	2025-12-22 09:36:34.628614670 -0800
@@ -701,6 +701,7 @@ function(register_repository)
       "Cloning ${GIT_NAME}"
     COMMAND
       ${CMAKE_COMMAND}
+        -DOFFLINE=${OFFLINE}
         -DGIT_PATH=${GIT_PATH}
         -DGIT_REPOSITORY=${GIT_REPOSITORY}
         -DGIT_NAME=${GIT_NAME}
--- a/cmake/scripts/DownloadZig.cmake.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/cmake/scripts/DownloadZig.cmake	2025-12-22 12:49:43.765768123 -0800
@@ -42,25 +42,27 @@ endif()
 
 set(ZIG_DOWNLOAD_URL https://github.com/oven-sh/zig/releases/download/autobuild-${ZIG_COMMIT}/${ZIG_FILENAME})
 
-execute_process(
-  COMMAND
-    ${CMAKE_COMMAND}
-      -DDOWNLOAD_URL=${ZIG_DOWNLOAD_URL}
-      -DDOWNLOAD_PATH=${ZIG_PATH}
-      -P ${CMAKE_CURRENT_LIST_DIR}/DownloadUrl.cmake
-  ERROR_STRIP_TRAILING_WHITESPACE
-  ERROR_VARIABLE
-    ZIG_DOWNLOAD_ERROR
-  RESULT_VARIABLE
-    ZIG_DOWNLOAD_RESULT
-)
+if(NOT OFFLINE)
+  execute_process(
+    COMMAND
+      ${CMAKE_COMMAND}
+        -DDOWNLOAD_URL=${ZIG_DOWNLOAD_URL}
+        -DDOWNLOAD_PATH=${ZIG_PATH}
+        -P ${CMAKE_CURRENT_LIST_DIR}/DownloadUrl.cmake
+    ERROR_STRIP_TRAILING_WHITESPACE
+    ERROR_VARIABLE
+      ZIG_DOWNLOAD_ERROR
+    RESULT_VARIABLE
+      ZIG_DOWNLOAD_RESULT
+  )
 
-if(NOT ZIG_DOWNLOAD_RESULT EQUAL 0)
-  message(FATAL_ERROR "Download failed: ${ZIG_DOWNLOAD_ERROR}")
-endif()
+  if(NOT ZIG_DOWNLOAD_RESULT EQUAL 0)
+    message(FATAL_ERROR "Download failed: ${ZIG_DOWNLOAD_ERROR}")
+  endif()
 
-if(NOT EXISTS ${ZIG_PATH}/${ZIG_EXE})
-  message(FATAL_ERROR "Executable not found: \"${ZIG_PATH}/${ZIG_EXE}\"")
+  if(NOT EXISTS ${ZIG_PATH}/${ZIG_EXE})
+    message(FATAL_ERROR "Executable not found: \"${ZIG_PATH}/${ZIG_EXE}\"")
+  endif()
 endif()
 
 # Tools like VSCode need a stable path to the zig executable, on both Unix and Windows
--- a/cmake/scripts/DownloadUrl.cmake.orig	2025-12-17 00:52:16.000000000 -0800
+++ b/cmake/scripts/DownloadUrl.cmake	2025-12-22 13:03:03.054109152 -0800
@@ -1,3 +1,6 @@
+if(OFFLINE)
+  return()
+endif()
 get_filename_component(SCRIPT_NAME ${CMAKE_CURRENT_LIST_FILE} NAME)
 message(STATUS "Running script: ${SCRIPT_NAME}")
 
--- a/cmake/targets/BuildBun.cmake.orig	2025-12-22 09:49:52.651121577 -0800
+++ b/cmake/targets/BuildBun.cmake	2025-12-22 13:04:18.539968273 -0800
@@ -773,6 +773,7 @@ register_command(
     "Download node ${NODEJS_VERSION} headers"
   COMMAND
     ${CMAKE_COMMAND}
+      -DOFFLINE=${OFFLINE}
       -DDOWNLOAD_PATH=${NODEJS_HEADERS_PATH}
       -DDOWNLOAD_URL=https://nodejs.org/dist/v${NODEJS_VERSION}/node-v${NODEJS_VERSION}-headers.tar.gz
       -P ${CWD}/cmake/scripts/DownloadUrl.cmake
